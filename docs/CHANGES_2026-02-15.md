# Changes - February 15, 2026

## Build Timestamp System Refactoring

### Summary
Refactored the deploy date/time display system to use environment variables injected at build time instead of a static JSON file. This provides a more robust and automated approach to tracking deployment timestamps.

### Changes Made

#### 1. New Files Created
- `lib/build-config.ts` - Build-time configuration that reads from environment variables
- `scripts/docker-build.sh` - Helper script for Docker builds with automatic timestamp
- `scripts/docker-compose-up.sh` - Helper script for Docker Compose with automatic timestamp

#### 2. Files Modified
- `components/DeployInfo.tsx` - Now imports from `lib/build-config.ts` instead of fetching JSON
- `app/page.tsx` - Now imports from `lib/build-config.ts` instead of fetching JSON
- `package.json` - Removed `prebuild` script, added new build commands with timestamp injection
- `Dockerfile` - Added `BUILD_TIMESTAMP` build argument
- `docker-compose.yml` - Added `BUILD_TIMESTAMP` build argument
- `docs/DEVELOPMENT.md` - Updated documentation to reflect new build process

#### 3. Files Deleted
- `public/build-info.json` - No longer needed (was generated at build time)
- `scripts/generate-build-info.js` - No longer needed (replaced by environment variables)

### Technical Details

#### Before
1. `scripts/generate-build-info.js` ran before every build (via `prebuild` script)
2. Generated `public/build-info.json` with current timestamp
3. Components fetched this JSON file via HTTP request
4. Required async state management in components

#### After
1. Build timestamp is passed via `NEXT_PUBLIC_BUILD_TIMESTAMP` environment variable
2. `lib/build-config.ts` reads this environment variable at build time
3. Next.js inlines this value during build (tree-shaking friendly)
4. Components import the value directly (synchronous, no network request)
5. More efficient - no runtime HTTP request needed

### Benefits

1. **Performance**: No HTTP request needed to fetch build info
2. **Simplicity**: Components import config directly instead of async fetching
3. **Reliability**: Timestamp is embedded in build, not a separate file
4. **Docker-friendly**: Build timestamp can be set via Docker build args
5. **Developer Experience**: Helper scripts make it easy to build with correct timestamp

### Build Commands

#### Local Development
```bash
npm run dev                    # Timestamp set automatically
npm run build:with-timestamp   # Production build with timestamp
```

#### Docker
```bash
npm run docker:build          # Build Docker image with timestamp
npm run docker:up             # Start with Docker Compose
./scripts/docker-build.sh     # Direct script execution
./scripts/docker-compose-up.sh # Direct script execution
```

#### Manual
```bash
# Set timestamp manually
NEXT_PUBLIC_BUILD_TIMESTAMP=$(date -u +"%Y-%m-%dT%H:%M:%S.000Z") npm run build

# Docker build with manual timestamp
docker build --build-arg BUILD_TIMESTAMP="2026-02-15T10:00:00.000Z" -t agentverse .
```

### Migration Notes

No migration needed for existing deployments. The new system:
- Falls back to current time if `NEXT_PUBLIC_BUILD_TIMESTAMP` is not set
- Works seamlessly in both development and production
- Compatible with all deployment methods (local, Docker, Docker Compose)

### Testing

Build process tested successfully:
- ✅ Local build with timestamp injection
- ✅ TypeScript compilation
- ✅ Components properly import BUILD_CONFIG
- ✅ Timestamp embedded in build output

### Related Files

- `lib/build-config.ts` - Main configuration file
- `components/DeployInfo.tsx` - Deploy info display component
- `app/page.tsx` - Main page using deploy date
- `scripts/docker-build.sh` - Docker build helper
- `scripts/docker-compose-up.sh` - Docker Compose helper
- `Dockerfile` - Docker configuration
- `docker-compose.yml` - Docker Compose configuration
- `package.json` - Build scripts
- `docs/DEVELOPMENT.md` - Developer documentation
